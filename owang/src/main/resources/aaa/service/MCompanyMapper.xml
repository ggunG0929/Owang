<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper 
PUBLIC "-//mybatis.org/DTD Mapper3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="aaa.service.MCompanyMapper">


<insert id="insertCompany" parameterType="mcDTO">
    INSERT INTO company (cemail,cid, cpw, cname, cbuild, ccategory, 
    cstaff, csales, ccall, cceo, caddress, ccompanyFile, ccontent, ctype, cbcnt, capproval)
    VALUES (
        #{cemail},#{cid},#{cpw},#{cname},#{cbuild},#{ccategory},#{cstaff},#{csales},
        #{ccall},#{cceo},#{caddress},#{ccompanyFile},
        #{ccontent},1,0,0
    )
</insert>

<select id="loginCompany" resultType="int">
    select count(*) from company where cid = #{userid} and cpw = #{userpw}
</select>

<select id="idChk" resultType="int">
    select count(*) from company where cid = #{cid}
</select>

<select id="getctype" resultType="Integer">
    select ctype from company where cid = #{cid}
</select>

<select  id="deatilCompany">
	select * from company where cid = #{cid}
</select>

<select  id="deatilaaaCompany">
	select * from company where cid = #{userid}
</select>

<update id="modifffy" parameterType="mcDTO">
		update company set 
		cname = #{cname},cemail = #{cemail}, cbuild= #{cbuild}, ccategory= #{ccategory}, ccompanyFile= #{ccompanyFile},
		cstaff = #{cstaff}, csales = #{csales}, ccontent = #{ccontent},cpw=#{cpw}
		where cid = #{cid} 
</update>

<delete id="delettt" parameterType="mcDTO">
	delete from company where cid =
	#{cid} and cpw = #{cpw}
</delete>

<update id="paycmember" parameterType="mcDTO">
	update company set
	ctype = #{ctype}, cdate = #{cdate}
	where cid = #{cid}
</update>
<update id="logincmember" parameterType="mcDTO">
	update company set
	ctype = #{ctype}
	where cid = #{cid}
</update>

<update id="fileDelete" parameterType="mcDTO">
	update company set
	ccompanyFile = null
	where cid = #{cid} and cpw=#{cpw}
</update>

<select id="findloCompany" resultType="Integer">
    select count(*) from company where cname = #{fname} and cemail = #{femail}
</select>
<select id="findid" resultType="mcDTO">
    select cid from company where cname = #{fname} and cemail = #{femail}
</select>
<select id="findpwComp" resultType="Integer">
    select count(*) from company where cid = #{fid} and cemail = #{femail} and cceo = #{fceo}
</select>
<update id="modifycpw">
		update company set cpw=#{cpw}
		where cid = #{cid} 
</update>

	<!-- 재훈 추가 -->
	<select id="applist" resultType="aDTO" parameterType="aDTO">
   	 	select 
	   	 	ano, recruit_id, recruit_title, sid, sname, rsid, apphoto, aptitle, apcareer, apcompany, apworkstart, apworkend, apwork, 
			apacademic, apacademicstat, apintroduce, aplicense, aplicenseorg, aplicenseyear, aplanguage, aplanguagelevel, 
			apsubmitdate, cname, cid, apcancel, apread, appass
   	 	from applicant 
   	 	where cid = #{cid}
	</select>
	
	<select id="apppasslist" resultType="aDTO" parameterType="aDTO">
   	 	select 
	   	 	ano, recruit_id, recruit_title, sid, sname, rsid, apphoto, aptitle, apcareer, apcompany, apworkstart, apworkend, apwork, 
			apacademic, apacademicstat, apintroduce, aplicense, aplicenseorg, aplicenseyear, aplanguage, aplanguagelevel, 
			apsubmitdate, cname, cid, apcancel, apread, appass
   	 	from applicant 
   	 	where cid = #{cid} and appass = 1
		limit #{start}, #{limit}
	</select>
	
	<select id="appnonpasslist" resultType="aDTO" parameterType="aDTO">
   	 	select 
	   	 	ano, recruit_id, recruit_title, sid, sname, rsid, apphoto, aptitle, apcareer, apcompany, apworkstart, apworkend, apwork, 
			apacademic, apacademicstat, apintroduce, aplicense, aplicenseorg, aplicenseyear, aplanguage, aplanguagelevel, 
			apsubmitdate, cname, cid, apcancel, apread, appass
   	 	from applicant 
   	 	where cid = #{cid} and appass = 2
		limit #{start}, #{limit}
	</select>	
	
	<select id="appdetail" resultType="aDTO">
		select * from applicant where ano = #{ano} and cid = #{cid}
	</select>

	<delete id="appdelete"  parameterType="aDTO">
		delete from applicant where ano = #{ano}
	</delete>
	
	<!-- 열람 -->
	<update id="appread" parameterType="Integer">
		update applicant set
		apread = 1
		where ano = #{ano}
	</update>
	
	<!-- 합격 -->
	<update id="apppass" parameterType="Integer">
		update applicant set
		appass = 1
		where ano = #{ano}
	</update>
	
	<!-- 불합격 -->
	<update id="appnonpass" parameterType="Integer">
		update applicant set
		appass = 2
		where ano = #{ano}
	</update>
	
	
	<select id="apptotal" resultType="Integer">
		select count(*) from applicant where cid = #{cid}
	</select>
</mapper>